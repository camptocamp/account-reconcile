<?xml version="1.0"?>
<openerp>
    <data>

        <record id="view_crm_case_claims_filter" model="ir.ui.view">
            <field name="name">crm.claim.filter</field>
            <field name="model">crm.claim</field>
            <field name="inherit_id" ref="crm_claim.view_crm_case_claims_filter"/>
            <field name="arch" type="xml">
                <field name="name" position="before">
                    <field name="description"/>
                </field>
            </field>
        </record>

        <record id="crm_case_claims_tree_view" model="ir.ui.view">
            <field name="name">CRM - Claims Tree</field>
            <field name="model">crm.claim</field>
            <field name="inherit_id" ref="crm_claim.crm_case_claims_tree_view"/>
            <field name="arch" type="xml">
                <field name="action_next" position="after">
                    <field name="write_date"/>
                </field>
                <field name="action_next" position="attributes">
                    <attribute name="invisible">1</attribute>
                </field>
                <field name="partner_id" position="after">
                    <field name="partner_street"/>
                    <field name="partner_zip"/>
                    <field name="partner_city"/>
                </field>
            </field>
        </record>

        <act_window
                id="act_crm_claim_rma_claim"
                name="Claims"
                res_model="crm.claim"
                src_model="crm.claim"/>

        <act_window
              id="act_crm_claim_rma_picking_out"
              name="Outgoing Shipment"
              res_model="stock.picking"
              src_model="crm.claim"
              context="{'active_test': False}"/>

        <record id="crm_claim_rma_form_view" model="ir.ui.view">
            <field name="name">crm.claim.rma.form</field>
            <field name="model">crm.claim</field>
            <field name="inherit_id" ref="crm_claim_rma.crm_claim_rma_form_view"/>
            <field name="arch" type="xml">
                <!-- add sales count -->
                <button icon="fa-strikethrough" position="attributes">
                  <attribute name="string"></attribute>
                </button>
                <button icon="fa-strikethrough" position="inside">
                  <field string="Sales" name="sale_order_count" widget="statinfo"/>
                </button>
                <!-- replace Purchase smart button by Claim smart button -->
                <button icon="fa-shopping-cart" position="replace">
                    <button class="oe_stat_button"
                            icon="fa-comments"
                            name="%(act_crm_claim_rma_claim)d"
                            type="action"
                            attrs="{'invisible': [('partner_id','=', False)]}"
                            context="{'search_default_partner_id': partner_id}">
                        <field string="Claims" name="claim_count" widget="statinfo"/>
                    </button>
                </button>
                <!-- add picking out smart button after "Returns" -->
                <button icon="fa-reply" position="after">
                    <button class="oe_stat_button"
                            icon="fa-truck"
                            name="%(act_crm_claim_rma_picking_out)d"
                            type="action"
                            string="Deliveries"
                            attrs="{'invisible': [('partner_id','=', False)]}"
                            context="{'search_default_partner_id': partner_id, 'search_default_user_id':False}"/>
                </button>

                <field name="team_id" position="after">
                    <field name="categ_id"
                           options="{'no_create': True, 'no_open': True}"
                           required="1"/>
                </field>
                <xpath expr="//notebook/page/group/field[@name='categ_id']"
                       position="replace"/>
                <field name="partner_id" position="attributes">
                    <attribute name="domain">[('parent_id', '=', False)]</attribute>
                </field>
                <field name="partner_id" position="after">
                    <field name="partner_category_ids" widget="many2many_tags"/>
                </field>
                <field name="partner_phone" position="attributes">
                    <attribute name="required">0</attribute>
                </field>
                <field name="invoice_id" position="attributes">
                    <attribute name="context">{'active_test': False}</attribute>
                </field>
                <field name="delivery_address_id" position="attributes">
                    <attribute name="attrs">{'invisible': [('pick', '=', True)]}</attribute>
                </field>
                <xpath expr="//field[@name='claim_line_ids']/tree/field[@name='state']" position="attributes">
                  <attribute name="invisible">1</attribute>
                </xpath>
                <xpath expr="//field[@name='claim_line_ids']/tree/field[@name='name']" position="attributes">
                  <attribute name="invisible">1</attribute>
                </xpath>
                <xpath expr="//field[@name='claim_line_ids']/tree/field[@name='claim_origin']" position="attributes">
                  <attribute name="invisible">1</attribute>
                </xpath>
                <xpath expr="//field[@name='claim_line_ids']/tree/field[@name='claim_diagnosis']" position="attributes">
                  <attribute name="invisible">1</attribute>
                </xpath>
                <xpath expr="//field[@name='claim_line_ids']/tree/field[@name='warranty_type']" position="after">
                  <field name="warranty_return_address"/>
                </xpath>
                <xpath expr="//field[@name='claim_line_ids']/tree/field[@name='prodlot_id']" position="replace">
                    <field name="return_instruction"/>
                </xpath>
                <button name="%(account.action_account_invoice_refund)d" position="attributes">
                    <attribute name="context">{'invoice_ids': [invoice_id], 'description': name, 'claim_id': id}</attribute>
                </button>
            </field>
        </record>


        <record id="sales_team_form_view_in_crm-notify" model="ir.ui.view">
            <field name="name">crm.team.form.notify</field>
            <field name="model">crm.team</field>
            <field name="inherit_id" ref="crm.sales_team_form_view_in_crm"/>
            <field name="arch" type="xml">
                <field name="active" position="after">
                    <field name="notify"/>
                </field>
            </field>
        </record>

     </data>
</openerp>
