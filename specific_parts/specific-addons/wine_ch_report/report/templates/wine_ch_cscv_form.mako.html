<!DOCTYPE html SYSTEM "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <style type="text/css">
${css}
/* Official */
.act_as_table {
  display: table;
}
.act_as_thead {
  display: table-header-group;
}
.act_as_tbody {
  display: table-row-group;
}
.act_as_tfoot {
  display: table-footer-group;
}
.act_as_row {
  display:table-row;
}
.act_as_cell {
  display: table-cell;
}
.list_table, .data_table {
  table-layout: fixed;
  border-collapse: separate;
  border-spacing: 5px;
  clear: both;
}
.title1 {
  font-size: 20px;
  font-weight: bold;
  text-align: left;
}
.title2 {
  font-size: 16px;
  font-weight: bold;
  text-decoration: underline;
  text-align: left;
}
.title3 {
  font-size: 14px;
  font-weight: bold;
  text-align: left;
}
.title4 {
  font-size: 12px;
  text-align: left;
}
.amount {
  text-align: right;
  white-space: nowrap;
  padding-right: 20px;
}
/***********/
.labels {
  background-color: #EEEEEE;
  text-align: center;
  font-weight: bold;
  padding-right: 3px;
  padding-left: 3px;
  white-space: nowrap;
  background-clip: border-box;
}
.list_table.act_as_cell {
  text-align: left;
  font-size: 12;
  padding-right: 3px;
  padding-left: 3px;
  padding-top: 3px;
  padding-bottom: 3px;
  white-space: nowrap;
  display: table-cell;
}

.visible_cell {
  border: 1px solid grey;
  height: 20px;
}
.invisible_cell {
  border: 0;
  background-color: white;
}
.col_code {
    width: 20px;
}
.col_color {
    width: 50px;
}

#doc_title {
    float: left;
    width: 19cm;
}
#exploitation_num {
    float: left;
}
#text1 {
    float: left;
    width: 19cm;
    clear: both;
    white-space: pre-line;
}
#address {
    float: left;
    white-space: pre-line;
}
#text2 {
    clear: both;
    float: left;
}
.underlined {
  text-decoration: underline;
}
    </style>
  </head>
  <body>
    <%!
    def amount(text):
        return text.replace('-', '&#8209;')  # replace by a non-breaking hyphen (it will not word-wrap between hyphen and numbers)
    %>

    <%setLang(user.lang)%>

      <div id=doc_title>
        <span class="title1">
          Formule A
        </span>
      </div>
      <div id="exploitation_num">
        <span class="underlined">
          N° d'exploitation: .............
        </span>
      </div>

      <div id="text1">
        Récapitulation des <span class="underlined">stocks de vins au ${inventory_date}</span>
        mentionnés à l'inventaire détaillé ci-joint
      </div>
      <div id="address">
        Contrôle suisse du commerce des vins
        Case postale 272
        8803 Rüschlikon
      </div>

      <div id="text2">
        <span class="underlined">
          Important:
        </span>
          Indications toujours en litres entiers
      </div>
    </div>


    <div class="act_as_table list_table" style="margin-top:5px;">
      <% total_volume = 0.0 %>
      <div class="act_as_thead labels">
        <div class="act_as_row">
          <div class="act_as_cell invisible_cell col_code"></div>
          <div class="act_as_cell invisible_cell"></div>
          %for color in wine_types:
              <div class="act_as_cell amount col_color">${color.name}</div>
          %endfor
        </div>
      </div>
      <div class="act_as_tbody">
        %for wine_class in wine_classes:
            <%doc>
                Print a wine class line filling by empty cells the table
            </%doc>
            <div class="act_as_row">
              <%
              if wine_class.child_ids:
                cell_style = 'invisible_cell'
              else:
                cell_style = 'visible_cell amount'
              level = len(str(wine_class.code))
              %>
              <div class="act_as_cell title${level} col_code">${wine_class.code if level in (2, 3) else ''}</div>
              <div class="act_as_cell title${level}">${wine_class.name}</div>
              %for wine_type in wine_types:
                  <%
                    if wine_class.code == '50' and wine_type.name in (u'Rosé', u'Mousseux', u'Autre'):
                        cell_style = 'invisible_cell'
                  %>
                  <div class="act_as_cell ${cell_style} col_color">${wine_stocks.get((wine_class.code, wine_type.id), '')}</div>
              %endfor
            </div>
        %endfor
      </div>
    </div>


  </body>
</html>
